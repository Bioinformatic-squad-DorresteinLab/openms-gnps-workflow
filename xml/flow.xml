<?xml version="1.0" encoding="ISO-8859-1" ?>
<flow name="openms">
  <object					name="workflowParameters"/>
  <collection     name="inputFiles"/>

  <!-- <collection   name="iniFiles"/> -->

  <object     name="iniFiles-featurefinder"/>
  <object     name="iniFiles-idmapper"/>
  <object     name="iniFiles-mapaligner"/>
  <object     name="iniFiles-featurelinker"/>
  <object     name="iniFiles-adductdecharger"/>
  <object     name="iniFiles-gnpsexport"/>
  <object     name="iniFiles-textexporter"/>

  <collection			name="featurefindermetabo"/>
  <collection			name="idmapper"/>
  <collection			name="mapalignerposeclustering"/>
  <collection			name="metaboliteadductdecharger"/>
  <collection			name="featurelinkerunlabeled"/>
  <collection     name="filefilter"/>
  <collection			name="gnpsexport"/>
  <!-- <collection			name="gnpssiriusexport"/> -->
  <collection			name="textexporter"/>

  <object     name="output"/>


  <action name="begin">
    <output port="flowParams"									object="workflowParameters"/>
    <output port="inputFiles"									collection="inputFiles"/>

    <output port="iniFiles-featurefinder"   object="iniFiles-featurefinder"/>
    <output port="iniFiles-idmapper"   object="iniFiles-idmapper"/>
    <output port="iniFiles-mapaligner"   object="iniFiles-mapaligner"/>
    <output port="iniFiles-featurelinker"   object="iniFiles-featurelinker"/>
    <output port="iniFiles-adductdecharger"   object="iniFiles-adductdecharger"/>
    <output port="iniFiles-gnpsexport"   object="iniFiles-gnpsexport"/>
    <output port="iniFiles-textexporter"   object="iniFiles-textexporter"/>
  </action>

  <action name="feature-finder-metabo">
    <input port="inputFiles"  object="inputFiles"/>
    <input port="iniFiles-featurefinder"  object="iniFiles-featurefinder"/>

    <output port="featurefindermetabo"  collection="featurefindermetabo"/>
  </action>

  <action name="id-mapper">
    <input port="inputFiles"  collection="inputFiles"/>
    <input port="iniFiles-idmapper" object="iniFiles-idmapper"/>
    <input port="featurefindermetabo" collection="featurefindermetabo"/>

    <output port="idmapper" collection="idmapper"/>
  </action>

  <action name="map-aligner-pose-clustering">
    <input port="idmapper"  collection="idmapper"/>
    <input port="iniFiles-mapaligner" object="iniFiles-mapaligner"/>

    <output port="mapalignerposeclustering" collection="mapalignerposeclustering"/>
  </action>

  <action name="metabolite-adduct-decharger">
    <input port="mapalignerposeclustering"  collection="mapalignerposeclustering"/>
    <input port="iniFiles-adductdecharger" object="iniFiles-adductdecharger"/>

    <output port="metaboliteadductdecharger"  collection="metaboliteadductdecharger"/>
  </action>

  <action name="feature-linker-unlabeled">
    <input port="metaboliteadductdecharger"  collection="metaboliteadductdecharger"/>
    <input port="iniFiles-featurelinker" object="iniFiles-featurelinker"/>
    <input port="flowParams"  object="workflowParameters"/>

    <output port="featurelinkerunlabeled" collection="featurelinkerunlabeled"/>
  </action>

  <action name="file-filter">
    <input port="featurelinkerunlabeled"  collection="featurelinkerunlabeled"/>

    <output port="filefilter" collection="filefilter"/>
  </action>

  <action name="gnps-export">
    <input port="filefilter" collection="filefilter"/>
    <input port="inputFiles" collection="inputFiles"/>
    <input port="iniFiles-gnpsexport" object="iniFiles-gnpsexport"/>
    <!-- <input port="flowParams"  object="workflowParameters"/> -->

    <output port="gnpsexport" collection="gnpsexport"/>
  </action>

  <!-- <action name="gnps-sirius-export">
    <input port="featurelinkerunlabeledkd" collection="featurelinkerunlabeledkd"/>
    <input port="iniFiles-gnpsexport" object="iniFiles-gnpsexport"/>
    <input port="inputFiles" collection="inputFiles"/>
    <input port="flowParams"  object="workflowParameters"/>

    <output port="gnpssiriusexport" collection="gnpssiriusexport"/>
  </action> -->

  <action name="text-exporter">
    <input port="filefilter" collection="filefilter"/>
    <input port="iniFiles-textexporter" object="iniFiles-textexporter"/>

    <output port="textexporter" collection="textexporter"/>
  </action>

  <action name="parse-output">
    <input port="featurefindermetabo" collection="featurefindermetabo"/>
    <input port="idmapper" collection="idmapper"/>
    <input port="mapalignerposeclustering" collection="mapalignerposeclustering"/>
    <input port="metaboliteadductdecharger"  collection="metaboliteadductdecharger"/>
    <input port="featurelinkerunlabeled" collection="featurelinkerunlabeled"/>
    <input port="filefilter"  collection="filefilter"/>
    <input port="gnpsexport" collection="gnpsexport"/>
    <input port="textexporter"   collection="textexporter"/>

    <output port="output" object="output"/>
  </action>

<!--
  <collection name="ms1_ms2_mgf_file"/>

  <action name="gnps-sirius-export">
    <input port="iniFiles-gnpsexport" object="iniFiles-gnpsexport"/>
    <input port="metaboliteadductdecharger" collection="metaboliteadductdecharger"/>
    <input port="flowParams"  object="workflowParameters"/>

    <output port="ms1_ms2_mgf_file" object="ms1_ms2_mgf_file"/>
  </action>
-->

<!--
  <action name="run_openms">
    <input port="flowParams"	object="workflowParameters"/>

    <input port="inputFiles"	collection="inputFiles"/>

    <input port="featurefindermetabo"				object="featurefindermetabo"/>
    <input port="idmapper"										object="idmapper"/>
    <input port="mapalignerposeclustering"		object="mapalignerposeclustering"/>
    <input port="featurelinkerunlabeledkd"		object="featurelinkerunlabeledkd"/>
    <input port="metaboliteadductdecharger"	object="metaboliteadductdecharger"/>
    <input port="gnpsexport"									object="gnpsexport"/>
    <input port="textexporter"									object="textexporter"/>

    <output port="output"                 collection="output"/>
    <output port="ms2_mgf_file"								object="ms2_mgf_file"/>
    <output port="ms1_ms2_mgf_file"						object="ms1_ms2_mgf_file"/>
  </action>
-->

  <!--
  ACTUAL WORKFLOW
  -->

  <action name="end">
    <input port="output"  object="output"/>
    <!-- <input port="ms1_ms2_mgf_file"						object="ms1_ms2_mgf_file"/> -->
  </action>
</flow>
