<toolset>

	<pathSet base="openms_2.4">
    <pathVar name="ld_library_path" path="/data/beta-proteomics2/tools/openms_2.4/openms-env/conda/lib"/>
    <pathVar name="exc_path" path="/data/beta-proteomics2/tools/openms_2.4/openms-env/openms-build/bin:/data/beta-proteomics2/tools/openms_2.4/openms-env/conda/bin:$PATH"/>
    <pathVar name="openms_data_path" path="/data/beta-proteomics2/tools/openms_2.4/openms-env/share"/>

		<toolPath tool="feature-finder-metabo" path="featurefindermetabo.py"/>
		<toolPath tool="id-mapper" path="idmapper.py"/>
    <pathVar  name="idmapper_empty" path="/data/beta-proteomics2/tools/openms/empty.idXML"/>
    <toolPath tool="map-aligner-pose-clustering"  path="mapalignerposeclustering.py"/>
    <toolPath tool="metabolite-adduct-decharger"  path="metaboliteadductdecharger.py"/>
    <toolPath tool="feature-linker-unlabeled"  path="featurelinkerunlabeled.py"/>
    <toolPath tool="file-filter"                  path="filefilter.py"/>
    <toolPath tool="gnps-export"                  path="gnpsexport.py"/>
    <toolPath tool="text-exporter"                  path="textexporter.py"/>
    <toolPath tool="parse-output"                  path="parse_output.py"/>
	</pathSet>

  <tool name="feature-finder-metabo">
    <require name="inputFiles"  type="folder"/>
    <require name="iniFiles-featurefinder"  type="file"/>

    <produce name="featurefindermetabo" type="folder"/>

    <execution env="python" argConvention="binary">
      <arg pathRef="ld_library_path"/>
      <arg pathRef="exc_path"/>
      <arg pathRef="openms_data_path"/>

      <arg valueRef="inputFiles"/>
      <arg valueRef="iniFiles-featurefinder"/>
      <arg valueRef="featurefindermetabo"/>
    </execution>
  </tool>

  <tool name="id-mapper">
    <require name="inputFiles"  type="folder"/>
    <require name="iniFiles-idmapper" type="file"/>
    <require name="featurefindermetabo" type="folder"/>
    <produce name="idmapper"  type="folder"/>

    <execution env="python" argConvention="binary">
      <arg pathRef="ld_library_path"/>
      <arg pathRef="exc_path"/>
      <arg pathRef="openms_data_path"/>

      <arg valueRef="inputFiles"/>
      <arg valueRef="iniFiles-idmapper"/>
      <arg pathRef="idmapper_empty"/>
      <arg valueRef="featurefindermetabo"/>
      <arg valueRef="idmapper"/>
    </execution>
  </tool>


  <tool name="map-aligner-pose-clustering">
    <require name="idmapper"  type="folder"/>
    <require name="iniFiles-mapaligner" type="file"/>
    <produce name="mapalignerposeclustering"  type="folder"/>

    <execution env="python" argConvention="binary">
      <arg pathRef="ld_library_path"/>
      <arg pathRef="exc_path"/>
      <arg pathRef="openms_data_path"/>

      <arg valueRef="idmapper"/>
      <arg valueRef="iniFiles-mapaligner"/>
      <arg valueRef="mapalignerposeclustering"/>
    </execution>
  </tool>


  <tool name="metabolite-adduct-decharger">
    <require name="mapalignerposeclustering" type="folder"/>
    <require name="iniFiles-adductdecharger" type="file"/>
    <produce name="metaboliteadductdecharger"  type="folder"/>

    <execution env="python" argConvention="binary">
      <arg pathRef="ld_library_path"/>
      <arg pathRef="exc_path"/>
      <arg pathRef="openms_data_path"/>

      <arg valueRef="mapalignerposeclustering"/>
      <arg valueRef="iniFiles-adductdecharger"/>
      <arg valueRef="metaboliteadductdecharger"/>
    </execution>
  </tool>


  <tool name="feature-linker-unlabeled">
    <require name="metaboliteadductdecharger"  type="folder"/>
    <require name="iniFiles-featurelinker" type="file"/>
    <require name="flowParams" type="file"/>
    <produce name="featurelinkerunlabeled"  type="folder"/>

    <execution env="python" argConvention="binary">
      <arg pathRef="ld_library_path"/>
      <arg pathRef="exc_path"/>
      <arg pathRef="openms_data_path"/>

      <arg valueRef="metaboliteadductdecharger"/>
      <arg valueRef="iniFiles-featurelinker"/>
      <arg valueRef="featurelinkerunlabeled"/>
      <arg valueRef="flowParams"/>
    </execution>
  </tool>


  <tool name="file-filter">
    <require name="featurelinkerunlabeled"  type="folder"/>
    <produce name="filefilter"  type="folder"/>

    <execution env="python" argConvention="binary">
      <arg pathRef="ld_library_path"/>
      <arg pathRef="exc_path"/>
      <arg pathRef="openms_data_path"/>

      <arg valueRef="featurelinkerunlabeled"/>
      <arg valueRef="filefilter"/>
    </execution>
  </tool>


  <tool name="gnps-export">
    <require name="filefilter"  type="folder"/>
    <require name="inputFiles"  type="folder"/>
    <require name="iniFiles-gnpsexport" type="file"/>
    <!-- <require name="flowParams" type="file"/> -->
    <produce name="gnpsexport"  type="folder"/>

    <execution env="python" argConvention="binary">
      <arg pathRef="ld_library_path"/>
      <arg pathRef="exc_path"/>
      <arg pathRef="openms_data_path"/>

      <arg valueRef="filefilter"/>
      <arg valueRef="inputFiles"/>
      <arg valueRef="iniFiles-gnpsexport"/>
      <!-- <arg valueRef="flowParams"/> -->
      <arg valueRef="gnpsexport"/>
    </execution>
  </tool>


  <tool name="text-exporter">
    <require name="filefilter"  type="folder"/>
    <require name="iniFiles-textexporter" type="file"/>
    <require name="flowParams" type="file"/>
    <produce name="textexporter"  type="folder"/>

    <execution env="python" argConvention="binary">
      <arg pathRef="ld_library_path"/>
      <arg pathRef="exc_path"/>
      <arg pathRef="openms_data_path"/>

      <arg valueRef="filefilter"/>
      <arg valueRef="iniFiles-textexporter"/>
      <arg valueRef="textexporter"/>
    </execution>
  </tool>


  <tool name="parse-output">
    <require name="featurefindermetabo" type="folder"/>
    <require name="idmapper"  type="folder"/>
    <require name="mapalignerposeclustering"  type="folder"/>
    <require name="featurelinkerunlabeled"  type="folder"/>
    <require name="metaboliteadductdecharger"  type="folder"/>
    <require name="gnpsexport"  type="folder"/>
    <require name="filefilter"  type="folder"/>
    <require name="textexporter"  type="folder"/>

    <produce name="output"  type="folder"/>

    <execution env="python" argConvention="binary">
      <arg valueRef="featurefindermetabo"/>
      <arg valueRef="idmapper"/>
      <arg valueRef="mapalignerposeclustering"/>
      <arg valueRef="metaboliteadductdecharger"/>
      <arg valueRef="featurelinkerunlabeled"/>
      <arg valueRef="filefilter"/>
      <arg valueRef="gnpsexport"/>
      <arg valueRef="textexporter"/>

      <arg valueRef="output"/>
    </execution>
  </tool>

</toolset>
